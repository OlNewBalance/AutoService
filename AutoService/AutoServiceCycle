namespace AutoService;

public class AutoServiceCycle
{
    public void Start()
    {
        while (true)
        {
            Console.WriteLine("Добро пожаловать в автосервис! Чтобы начать нажмите ENTER.");
            if (Console.ReadLine() == "") ;
            {
                AutoService.AutosRenderer(AutoService.AutoQueue);
                Console.WriteLine($"В автосервис подъехало {AutoService.QueueOfAuto.Count} машин!");
                Console.WriteLine("Обслужить??? ENTER.");
                if (Console.ReadLine() == "") ;
                {
                    if (AutoService.QueueOfAuto == null || AutoService.QueueOfAuto.Count == 0)
                    {
                        Console.WriteLine("Очередь машин пуста!");
                        return;
                    }

                    for (int i = 0; i < AutoService.QueueOfAuto.Count; i++)
                    {
                        Console.WriteLine($"Обслуживаем {i + 1}-ю машину!");

                        // Для Queue используем ElementAt или ToArray()
                        var currentAuto = AutoService.QueueOfAuto.ElementAt(i);
                        AutoService.AcceptCar(currentAuto);
                        Console.WriteLine($"Бюджет:{AutoService._balance}");
                        Console.WriteLine("Состояние склада:");
                        foreach (var AutoElements in AutoService.elementsStorage)
                        {
                            Console.WriteLine(AutoElements);
                        }

                        Console.WriteLine("Закупиться запчастями? Y/Enter");
                        if (Console.ReadLine() == "Y")
                        {
                            // Радио
                            Console.WriteLine("Сколько радио?");
                            string radioInput = Console.ReadLine();
                            if (!string.IsNullOrEmpty(radioInput))
                            {
                                AutoService.ToAddRadio = Convert.ToInt32(radioInput); // Используем radioInput!
                            }

                            Console.WriteLine("Enter");
                            Console.ReadLine();

                            // Колеса
                            Console.WriteLine("Сколько колес?");
                            string wheelInput = Console.ReadLine();
                            if (!string.IsNullOrEmpty(wheelInput))
                            {
                                AutoService.ToAddWheel = Convert.ToInt32(wheelInput); // Используем wheelInput!
                            }

                            // Карбюраторы
                            Console.WriteLine("Сколько карбюраторов?");
                            string carbureatorInput = Console.ReadLine();
                            if (!string.IsNullOrEmpty(carbureatorInput))
                            {
                                AutoService.ToAddCarbureator = Convert.ToInt32(carbureatorInput);
                            }

                            // Двигатели
                            Console.WriteLine("Сколько двигателей?");
                            string engineInput = Console.ReadLine();
                            if (!string.IsNullOrEmpty(engineInput))
                            {
                                AutoService.ToAddEngine = Convert.ToInt32(engineInput);
                            }

                            // Фары
                            Console.WriteLine("Сколько фар?");
                            string headInput = Console.ReadLine();
                            if (!string.IsNullOrEmpty(headInput))
                            {
                                AutoService.ToAddHeadlights = Convert.ToInt32(headInput);
                            }

                            int BuyExpenses = AutoService.ExpensesCalc(
                                AutoService.ToAddRadio,
                                AutoService.ToAddWheel,
                                AutoService.ToAddCarbureator,
                                AutoService.ToAddEngine,
                                AutoService.ToAddHeadlights
                            );

                            Console.WriteLine("Enter");

                            if (AutoService._balance >= BuyExpenses)
                            {
                                AutoService.AutoElementsRenderer(1, AutoService.ToAddWheel);
                                AutoService.AutoElementsRenderer(2, AutoService.ToAddEngine);
                                AutoService.AutoElementsRenderer(3, AutoService.ToAddHeadlights);
                                AutoService.AutoElementsRenderer(4, AutoService.ToAddRadio);
                                AutoService.AutoElementsRenderer(5, AutoService.ToAddCarbureator);
                                AutoService._balance -= BuyExpenses;
                                Console.WriteLine($"Было потрачено - {BuyExpenses}");
                            }
                            else if (AutoService._balance < BuyExpenses)
                            {
                                Console.WriteLine($"Вам не хватает - {BuyExpenses}");
                            }
                        }

                        Console.WriteLine("Нажмите ENTER для продолжения...");
                    }

                    Console.WriteLine("Все машины обслужены!");
                }
            }
        }
    }
}
